---
import BlogIndex from "../../../components/blog/BlogIndex.astro";
import BlogLayout from "../../../components/blog/BlogLayout.astro";
import Navbar from "../../../components/Navbar.astro";
import { getCollection, type CollectionEntry } from "astro:content";

type BlogPost = CollectionEntry<"blog">;

/* ðŸ”¥ Generar rutas por categorÃ­a */
export async function getStaticPaths() {
  const posts = await getCollection("blog");

  const categories = [...new Set(posts.map((p: BlogPost) => p.data.category))];

  return categories.map((category) => ({
    params: { category },
  }));
}

const { category } = Astro.params;

const posts = (await getCollection("blog")).filter(
  (p: BlogPost) => p.data.category === category
);
---

<BlogLayout
  title={`Blog Â· ${category}`}
  description={`ArtÃ­culos sobre ${category}`}
>
  <Navbar slot="navbar" />
  <BlogIndex posts={posts} />
</BlogLayout>
